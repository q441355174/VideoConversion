<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:views="clr-namespace:VideoConversion_Client.Views"
        x:Class="VideoConversion_Client.MainWindow"
        Title="视频转换工具"
        Width="1200" Height="800"
        MinWidth="1000" MinHeight="700"
        WindowStartupLocation="CenterScreen"
        >

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- 顶部标题栏 -->
        <Border Grid.Row="0" Background="#2c3e50" Padding="20,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="🎬" FontSize="24" Margin="0,0,10,0" />
                    <TextBlock Text="视频转换工具"
                               FontSize="20"
                               FontWeight="Bold"
                               Foreground="White"
                               VerticalAlignment="Center" />
                    <TextBlock Text="基于HandBrake的强大视频转换功能"
                               FontSize="12"
                               Foreground="#bdc3c7"
                               VerticalAlignment="Center"
                               Margin="20,0,0,0" />
                </StackPanel>

                <!-- 连接状态指示器 -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="连接状态:" FontSize="12" Foreground="#bdc3c7" Margin="0,0,8,0" />
                    <Border Name="ConnectionIndicator"
                            Width="12" Height="12"
                            Background="Red"
                            CornerRadius="6"
                            VerticalAlignment="Center" />
                    <TextBlock Name="ConnectionStatusText"
                               Text="未连接"
                               FontSize="12"
                               Foreground="#bdc3c7"
                               Margin="8,0,0,0" />
                </StackPanel>
            </Grid>
        </Border>

        <!-- 主要内容区域 -->
        <Grid Grid.Row="1" Background="#ecf0f1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <!-- 左侧：文件上传和转换设置 -->
            <ScrollViewer Grid.Column="0" Margin="5,5,2,5">
                <StackPanel Spacing="5">

                    <!-- 文件上传组件 -->
                    <views:FileUploadView Name="FileUploadView" />

                    <!-- 转换设置组件 -->
                    <views:ConversionSettingsView Name="ConversionSettingsView" />


                    <!-- 上传进度区域 -->
                    <Border Name="UploadProgressSection"
                            Classes="modern-card progress-card"
                            IsVisible="False">
                        <StackPanel Spacing="15">
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <TextBlock Text="📤" FontSize="18" />
                                <TextBlock Text="文件上传进度" Classes="card-title" />
                            </StackPanel>

                            <ProgressBar Name="UploadProgressBar"
                                         Height="8"
                                         Maximum="100"
                                         Value="0"
                                         Classes="modern-progress" />

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                                    <TextBlock Name="UploadPercentage" Text="0%" FontWeight="Bold" HorizontalAlignment="Center" />
                                    <TextBlock Text="完成度" FontSize="11" Foreground="#7f8c8d" HorizontalAlignment="Center" />
                                </StackPanel>

                                <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                    <TextBlock Name="UploadSpeed" Text="0 MB/s" FontWeight="Bold" HorizontalAlignment="Center" />
                                    <TextBlock Text="上传速度" FontSize="11" Foreground="#7f8c8d" HorizontalAlignment="Center" />
                                </StackPanel>

                                <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                                    <TextBlock Name="UploadTimeRemaining" Text="计算中..." FontWeight="Bold" HorizontalAlignment="Center" />
                                    <TextBlock Text="剩余时间" FontSize="11" Foreground="#7f8c8d" HorizontalAlignment="Center" />
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>

            <!-- 右侧：当前任务和历史记录 -->
            <ScrollViewer Grid.Column="1" Margin="2,5,5,5">
                <StackPanel Spacing="5">

                    <!-- 当前任务组件 -->
                    <views:CurrentTaskView Name="CurrentTaskView" />

                    <!-- 最近任务组件 -->
                    <views:RecentTasksView Name="RecentTasksView" />

                    <!-- 测试连接按钮 -->
                    <Button Name="TestConnectionButton"
                            Content="🔗 测试服务器连接"
                            Classes="secondary-button"
                            HorizontalAlignment="Stretch"
                            Click="TestConnectionButton_Click" />
                </StackPanel>
            </ScrollViewer>
        </Grid>

        <!-- 状态栏 -->
        <Border Grid.Row="2" Background="#34495e" Padding="20,12">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <TextBlock Name="StatusText"
                           Grid.Column="0"
                           Text="就绪 - 请选择视频文件开始转换"
                           VerticalAlignment="Center"
                           FontSize="13"
                           Foreground="White" />

                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="15">
                    <TextBlock Text="服务器:" FontSize="12" Foreground="#bdc3c7" VerticalAlignment="Center" />
                    <TextBlock Name="ServerUrl" Text="localhost:5065" FontSize="12" Foreground="White" VerticalAlignment="Center" />
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
