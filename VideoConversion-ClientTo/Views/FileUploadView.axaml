<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:VideoConversion_ClientTo.Presentation.ViewModels"
             x:Class="VideoConversion_ClientTo.Views.FileUploadView"
             x:DataType="vm:FileUploadViewModel">

    <!-- 主容器 -->
    <Border Background="White"
            BorderBrush="#dee2e6"
            BorderThickness="1"
            CornerRadius="12"
            Margin="16">
        <Border.Effect>
            <DropShadowEffect Color="#000000"
                              Opacity="0.05"
                              BlurRadius="6"
                              OffsetX="0"
                              OffsetY="2" />
        </Border.Effect>

        <Grid Background="Transparent">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <!-- 底部全局设置区域 -->
            <Border Grid.Row="2"
                    Background="#f8f9fa"
                    BorderBrush="#e9ecef"
                    BorderThickness="0,1,0,0"
                    CornerRadius="0,0,12,12"
                    Margin="0,0,0,0"
                    Padding="20,16">

                <!-- 设置选项 -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="20" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <!-- 输出格式 -->
                    <TextBlock Grid.Column="0"
                            Text="输出格式"
                            FontSize="14"
                            Foreground="#6c757d"
                            VerticalAlignment="Center" />
                    <ComboBox Grid.Column="1"
                            Name="OutputFormatCombo"
                            SelectedIndex="0"
                            Height="32"
							  Width="120"
                            CornerRadius="6"
                            BorderBrush="#ced4da">
                        <ComboBoxItem Content="MP4" />
                        <ComboBoxItem Content="AVI" />
                        <ComboBoxItem Content="MOV" />
                        <ComboBoxItem Content="MKV" />
                        <ComboBoxItem Content="WebM" />
                    </ComboBox>

                    <!-- 输出位置 -->
                    <TextBlock Grid.Column="3"
                            Text="输出位置"
                            FontSize="14"
                            Foreground="#6c757d"
                            VerticalAlignment="Center" />
                    <ComboBox Grid.Column="4"
                            Name="OutputFolderCombo"
                            SelectedIndex="0"
                            Height="32"
							  Width="160"
                            CornerRadius="6"
                            BorderBrush="#ced4da">
                        <ComboBoxItem Content="与源文件相同目录" />
                        <ComboBoxItem Content="自定义目录" />
                    </ComboBox>

                    <!-- 高级选项 -->
                    <StackPanel Grid.Column="6"
                                Orientation="Horizontal"
                                Spacing="12"
                                VerticalAlignment="Center">

                        <!-- 转码设置按钮 -->
                        <Button Name="ConversionSettingsBtn"
                                Content="⚙️ 转码设置"
                                Background="#6c757d"
                                Foreground="White"
                                BorderThickness="0"
                                Padding="12,8"
                                CornerRadius="6"
                                FontSize="13"
                                Command="{Binding OpenConversionSettingsCommand}">
                            <Button.Styles>
                                <Style Selector="Button:pointerover">
                                    <Setter Property="Background" Value="#5a6268" />
                                </Style>
                            </Button.Styles>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- 文件管理操作区域 -->
            <Border Grid.Row="1"
                    Background="#f8f9fa"
                    BorderBrush="#e9ecef"
                    BorderThickness="0,1,0,0"
                    CornerRadius="0"
                    Margin="0,0,0,0"
                    Padding="16,16">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <!-- 文件操作按钮 -->
                    <StackPanel Grid.Column="0"
                                Orientation="Horizontal"
                                Spacing="12"
                                VerticalAlignment="Center">
                        <Button Name="QuickSelectBtn"
                                Content="📄 选择文件"
                                Background="#007bff"
                                Foreground="White"
                                BorderThickness="0"
                                Padding="16,10"
                                CornerRadius="6"
                                FontSize="13"
                                FontWeight="Medium"
                                Command="{Binding SelectFileCommand}">
                            <Button.Styles>
                                <Style Selector="Button:pointerover">
                                    <Setter Property="Background" Value="#0056b3" />
                                </Style>
                            </Button.Styles>
                        </Button>

                        <Button Name="QuickSelectFolderBtn"
                                Content="📂 选择文件夹"
                                Background="Transparent"
                                Foreground="#007bff"
                                BorderBrush="#007bff"
                                BorderThickness="1"
                                Padding="16,10"
                                CornerRadius="6"
                                FontSize="13"
                                FontWeight="Medium"
                                Command="{Binding SelectFolderCommand}">
                            <Button.Styles>
                                <Style Selector="Button:pointerover">
                                    <Setter Property="Background" Value="#e3f2fd" />
                                </Style>
                            </Button.Styles>
                        </Button>

                        <Button Content="🗑️ 清空列表"
                                Background="Transparent"
                                Foreground="#dc3545"
                                BorderBrush="#dc3545"
                                BorderThickness="1"
                                Padding="12,8"
                                CornerRadius="6"
                                FontSize="13"
                                Command="{Binding ClearAllCommand}">
                            <Button.Styles>
                                <Style Selector="Button:pointerover">
                                    <Setter Property="Background" Value="#f8d7da" />
                                </Style>
                            </Button.Styles>
                        </Button>
                    </StackPanel>

                    <!-- 文件统计信息 -->
                    <StackPanel Grid.Column="1"
                                Orientation="Horizontal"
                                Spacing="8"
                                VerticalAlignment="Center"
                                Margin="0,0,16,0">
                        <TextBlock Text="📊" FontSize="12" />
                        <TextBlock Name="FileCountText" Text="{Binding FileCountText}" FontSize="12" Foreground="#6c757d" />
                        <TextBlock Text="•" FontSize="12" Foreground="#dee2e6" />
                        <TextBlock Name="TotalSizeText" Text="{Binding TotalSizeText}" FontSize="12" Foreground="#6c757d" />
                    </StackPanel>

                    <!-- 转换全部按钮 -->
                    <Button Grid.Column="2"
                            Content="🚀 转换全部"
                            Background="#28a745"
                            Foreground="White"
                            BorderThickness="0"
                            Padding="20,10"
                            CornerRadius="8"
                            FontSize="14"
                            FontWeight="Medium"
                            Command="{Binding ConvertAllCommand}">
                        <Button.Styles>
                            <Style Selector="Button:pointerover">
                                <Setter Property="Background" Value="#218838" />
                            </Style>
                        </Button.Styles>
                    </Button>
                </Grid>
            </Border>

            <!-- 中间文件拖拽区域 - 填充剩余空间 -->
            <Border Grid.Row="0"
                    Name="EmptyStateView"
                    DragDrop.AllowDrop="True"
                    Background="Transparent"
                    BorderBrush="Transparent"
                    BorderThickness="0"
                    CornerRadius="12,12,0,0"
                    Margin="0,0,0,0"
                    Padding="32"
                    IsVisible="{Binding IsEmptyStateVisible}">
                <Border.Styles>
                    <Style Selector="Border:pointerover">
                        <Setter Property="BorderBrush" Value="#9b59b6" />
                        <Setter Property="Background" Value="#faf8ff" />
                    </Style>
                </Border.Styles>
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="24">
                    <!-- 拖拽图标 -->
                    <Border Background="#f8f9fa"
                            BorderBrush="#dee2e6"
                            BorderThickness="2"
                            CornerRadius="50"
                            Width="100"
                            Height="100"
                            HorizontalAlignment="Center">
                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="4">
                            <TextBlock Text="📁"
                                    FontSize="32"
                                    HorizontalAlignment="Center" />
                            <TextBlock Text="+"
                                    FontSize="20"
                                    Foreground="#9b59b6"
                                    FontWeight="Bold"
                                    HorizontalAlignment="Center" />
                        </StackPanel>
                    </Border>

                    <!-- 主要提示文字 -->
                    <StackPanel HorizontalAlignment="Center" Spacing="8">
                        <TextBlock Text="拖拽视频文件到这里"
                                FontSize="20"
                                FontWeight="SemiBold"
                                HorizontalAlignment="Center"
                                Foreground="#495057" />
                        <TextBlock Text="或点击上方按钮选择文件"
                                FontSize="14"
                                HorizontalAlignment="Center"
                                Foreground="#6c757d" />
                    </StackPanel>

                    <!-- 支持的格式提示 -->
                    <Border Background="#e3f2fd"
                            BorderBrush="#bbdefb"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="16,12"
                            HorizontalAlignment="Center">
                        <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                            <TextBlock Text="💡" FontSize="14" VerticalAlignment="Center" />
                            <TextBlock Text="支持格式："
                                    FontSize="13"
                                    Foreground="#1976d2"
                                    FontWeight="Medium"
                                    VerticalAlignment="Center" />
                            <TextBlock Text="MP4, AVI, MOV, MKV, WMV, FLV, WebM"
                                    FontSize="13"
                                    Foreground="#1976d2"
                                    VerticalAlignment="Center" />
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- 状态2：文件列表状态 -->
            <Grid Grid.Row="0" Name="FileListView" IsVisible="{Binding IsFileListVisible}">
                <!-- 文件列表容器 -->
                <Border DragDrop.AllowDrop="True"
                        Background="Transparent"
                        BorderBrush="Transparent"
                        BorderThickness="0"
                        CornerRadius="12,12,0,0"
                        Margin="0">
                    <!-- 文件列表内容 -->
                    <ScrollViewer VerticalScrollBarVisibility="Auto"
                                  HorizontalScrollBarVisibility="Disabled">
                        <ItemsControl ItemsSource="{Binding FileItems}" Margin="16,16,16,0">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <!-- 文件项模板将在下一部分添加 -->
                                    <Border Background="#f8f9fa" BorderBrush="#e9ecef" BorderThickness="1" 
                                            CornerRadius="8" Margin="0,0,0,12" Padding="16">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <TextBlock Grid.Column="0" Text="📹" FontSize="20" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                            
                                            <StackPanel Grid.Column="1">
                                                <TextBlock Text="{Binding FileName}" FontWeight="SemiBold" FontSize="14"/>
                                                <TextBlock Text="{Binding FilePath}" FontSize="12" Foreground="#6c757d" TextTrimming="CharacterEllipsis"/>
                                                <TextBlock Text="{Binding FileSize}" FontSize="12" Foreground="#28a745"/>
                                            </StackPanel>
                                            
                                            <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="8">
                                                <Button Content="🚀" ToolTip.Tip="开始转换" Padding="8" Background="#28a745" Foreground="White" BorderThickness="0" CornerRadius="4"/>
                                                <Button Content="🗑️" ToolTip.Tip="移除" Padding="8" Background="#dc3545" Foreground="White" BorderThickness="0" CornerRadius="4"/>
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Border>
            </Grid>
        </Grid>
    </Border>

</UserControl>
