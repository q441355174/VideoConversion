<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:VideoConversion_ClientTo.Presentation.ViewModels"
             x:Class="VideoConversion_ClientTo.Views.FileUploadView"
             x:DataType="vm:FileUploadViewModel">

    <!-- ä¸»å®¹å™¨ -->
    <Border Background="White"
            BorderBrush="#dee2e6"
            BorderThickness="1"
            CornerRadius="12"
            Margin="16">
        <Border.Effect>
            <DropShadowEffect Color="#000000"
                              Opacity="0.05"
                              BlurRadius="6"
                              OffsetX="0"
                              OffsetY="2" />
        </Border.Effect>

        <Grid Background="Transparent">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <!-- åº•éƒ¨å…¨å±€è®¾ç½®åŒºåŸŸ -->
            <Border Grid.Row="2"
                    Background="#f8f9fa"
                    BorderBrush="#e9ecef"
                    BorderThickness="0,1,0,0"
                    CornerRadius="0,0,12,12"
                    Margin="0,0,0,0"
                    Padding="20,16">

                <!-- è®¾ç½®é€‰é¡¹ -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="20" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <!-- è¾“å‡ºæ ¼å¼ -->
                    <TextBlock Grid.Column="0"
                            Text="è¾“å‡ºæ ¼å¼"
                            FontSize="14"
                            Foreground="#6c757d"
                            VerticalAlignment="Center" />
                    <ComboBox Grid.Column="1"
                            Name="OutputFormatCombo"
                            SelectedIndex="0"
                            Height="32"
							  Width="120"
                            CornerRadius="6"
                            BorderBrush="#ced4da">
                        <ComboBoxItem Content="MP4" />
                        <ComboBoxItem Content="AVI" />
                        <ComboBoxItem Content="MOV" />
                        <ComboBoxItem Content="MKV" />
                        <ComboBoxItem Content="WebM" />
                    </ComboBox>

                    <!-- è¾“å‡ºä½ç½® -->
                    <TextBlock Grid.Column="3"
                            Text="è¾“å‡ºä½ç½®"
                            FontSize="14"
                            Foreground="#6c757d"
                            VerticalAlignment="Center" />
                    <ComboBox Grid.Column="4"
                            Name="OutputFolderCombo"
                            SelectedIndex="0"
                            Height="32"
							  Width="160"
                            CornerRadius="6"
                            BorderBrush="#ced4da">
                        <ComboBoxItem Content="ä¸Žæºæ–‡ä»¶ç›¸åŒç›®å½•" />
                        <ComboBoxItem Content="è‡ªå®šä¹‰ç›®å½•" />
                    </ComboBox>

                    <!-- é«˜çº§é€‰é¡¹ -->
                    <StackPanel Grid.Column="6"
                                Orientation="Horizontal"
                                Spacing="12"
                                VerticalAlignment="Center">

                        <!-- è½¬ç è®¾ç½®æŒ‰é’® -->
                        <Button Name="ConversionSettingsBtn"
                                Content="âš™ï¸ è½¬ç è®¾ç½®"
                                Background="#6c757d"
                                Foreground="White"
                                BorderThickness="0"
                                Padding="12,8"
                                CornerRadius="6"
                                FontSize="13"
                                Command="{Binding OpenConversionSettingsCommand}">
                            <Button.Styles>
                                <Style Selector="Button:pointerover">
                                    <Setter Property="Background" Value="#5a6268" />
                                </Style>
                            </Button.Styles>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- æ–‡ä»¶ç®¡ç†æ“ä½œåŒºåŸŸ -->
            <Border Grid.Row="1"
                    Background="#f8f9fa"
                    BorderBrush="#e9ecef"
                    BorderThickness="0,1,0,0"
                    CornerRadius="0"
                    Margin="0,0,0,0"
                    Padding="16,16">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <!-- æ–‡ä»¶æ“ä½œæŒ‰é’® -->
                    <StackPanel Grid.Column="0"
                                Orientation="Horizontal"
                                Spacing="12"
                                VerticalAlignment="Center">
                        <Button Name="QuickSelectBtn"
                                Content="ðŸ“„ é€‰æ‹©æ–‡ä»¶"
                                Background="#007bff"
                                Foreground="White"
                                BorderThickness="0"
                                Padding="16,10"
                                CornerRadius="6"
                                FontSize="13"
                                FontWeight="Medium"
                                Command="{Binding SelectFileCommand}">
                            <Button.Styles>
                                <Style Selector="Button:pointerover">
                                    <Setter Property="Background" Value="#0056b3" />
                                </Style>
                            </Button.Styles>
                        </Button>

                        <Button Name="QuickSelectFolderBtn"
                                Content="ðŸ“‚ é€‰æ‹©æ–‡ä»¶å¤¹"
                                Background="Transparent"
                                Foreground="#007bff"
                                BorderBrush="#007bff"
                                BorderThickness="1"
                                Padding="16,10"
                                CornerRadius="6"
                                FontSize="13"
                                FontWeight="Medium"
                                Command="{Binding SelectFolderCommand}">
                            <Button.Styles>
                                <Style Selector="Button:pointerover">
                                    <Setter Property="Background" Value="#e3f2fd" />
                                </Style>
                            </Button.Styles>
                        </Button>

                        <Button Content="ðŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨"
                                Background="Transparent"
                                Foreground="#dc3545"
                                BorderBrush="#dc3545"
                                BorderThickness="1"
                                Padding="12,8"
                                CornerRadius="6"
                                FontSize="13"
                                Command="{Binding ClearAllCommand}">
                            <Button.Styles>
                                <Style Selector="Button:pointerover">
                                    <Setter Property="Background" Value="#f8d7da" />
                                </Style>
                            </Button.Styles>
                        </Button>
                    </StackPanel>

                    <!-- æ–‡ä»¶ç»Ÿè®¡ä¿¡æ¯ -->
                    <StackPanel Grid.Column="1"
                                Orientation="Horizontal"
                                Spacing="8"
                                VerticalAlignment="Center"
                                Margin="0,0,16,0">
                        <TextBlock Text="ðŸ“Š" FontSize="12" />
                        <TextBlock Name="FileCountText" Text="{Binding FileCountText}" FontSize="12" Foreground="#6c757d" />
                        <TextBlock Text="â€¢" FontSize="12" Foreground="#dee2e6" />
                        <TextBlock Name="TotalSizeText" Text="{Binding TotalSizeText}" FontSize="12" Foreground="#6c757d" />
                    </StackPanel>

                    <!-- è½¬æ¢å…¨éƒ¨æŒ‰é’® -->
                    <Button Grid.Column="2"
                            Content="ðŸš€ è½¬æ¢å…¨éƒ¨"
                            Background="#28a745"
                            Foreground="White"
                            BorderThickness="0"
                            Padding="20,10"
                            CornerRadius="8"
                            FontSize="14"
                            FontWeight="Medium"
                            Command="{Binding StartConversionCommand}">
                        <Button.Styles>
                            <Style Selector="Button:pointerover">
                                <Setter Property="Background" Value="#218838" />
                            </Style>
                        </Button.Styles>
                    </Button>
                </Grid>
            </Border>

            <!-- ä¸­é—´æ–‡ä»¶æ‹–æ‹½åŒºåŸŸ - å¡«å……å‰©ä½™ç©ºé—´ -->
            <Border Grid.Row="0"
                    Name="EmptyStateView"
                    DragDrop.AllowDrop="True"
                    Background="Transparent"
                    BorderBrush="Transparent"
                    BorderThickness="0"
                    CornerRadius="12,12,0,0"
                    Margin="0,0,0,0"
                    Padding="32"
                    IsVisible="{Binding IsEmptyStateVisible}">
                <Border.Styles>
                    <Style Selector="Border:pointerover">
                        <Setter Property="BorderBrush" Value="#9b59b6" />
                        <Setter Property="Background" Value="#faf8ff" />
                    </Style>
                </Border.Styles>
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="24">
                    <!-- æ‹–æ‹½å›¾æ ‡ -->
                    <Border Background="#f8f9fa"
                            BorderBrush="#dee2e6"
                            BorderThickness="2"
                            CornerRadius="50"
                            Width="100"
                            Height="100"
                            HorizontalAlignment="Center">
                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="4">
                            <TextBlock Text="ðŸ“"
                                    FontSize="32"
                                    HorizontalAlignment="Center" />
                            <TextBlock Text="+"
                                    FontSize="20"
                                    Foreground="#9b59b6"
                                    FontWeight="Bold"
                                    HorizontalAlignment="Center" />
                        </StackPanel>
                    </Border>

                    <!-- ä¸»è¦æç¤ºæ–‡å­— -->
                    <StackPanel HorizontalAlignment="Center" Spacing="8">
                        <TextBlock Text="æ‹–æ‹½è§†é¢‘æ–‡ä»¶åˆ°è¿™é‡Œ"
                                FontSize="20"
                                FontWeight="SemiBold"
                                HorizontalAlignment="Center"
                                Foreground="#495057" />
                        <TextBlock Text="æˆ–ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®é€‰æ‹©æ–‡ä»¶"
                                FontSize="14"
                                HorizontalAlignment="Center"
                                Foreground="#6c757d" />
                    </StackPanel>

                    <!-- æ”¯æŒçš„æ ¼å¼æç¤º -->
                    <Border Background="#e3f2fd"
                            BorderBrush="#bbdefb"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="16,12"
                            HorizontalAlignment="Center">
                        <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                            <TextBlock Text="ðŸ’¡" FontSize="14" VerticalAlignment="Center" />
                            <TextBlock Text="æ”¯æŒæ ¼å¼ï¼š"
                                    FontSize="13"
                                    Foreground="#1976d2"
                                    FontWeight="Medium"
                                    VerticalAlignment="Center" />
                            <TextBlock Text="MP4, AVI, MOV, MKV, WMV, FLV, WebM"
                                    FontSize="13"
                                    Foreground="#1976d2"
                                    VerticalAlignment="Center" />
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- çŠ¶æ€2ï¼šæ–‡ä»¶åˆ—è¡¨çŠ¶æ€ -->
            <Grid Grid.Row="0" Name="FileListView" IsVisible="{Binding IsFileListVisible}">
                <!-- æ–‡ä»¶åˆ—è¡¨å®¹å™¨ -->
                <Border DragDrop.AllowDrop="True"
                        Background="Transparent"
                        BorderBrush="Transparent"
                        BorderThickness="0"
                        CornerRadius="12,12,0,0"
                        Margin="0">
                    <!-- æ–‡ä»¶åˆ—è¡¨å†…å®¹ -->
                    <ScrollViewer VerticalScrollBarVisibility="Auto"
                                  HorizontalScrollBarVisibility="Disabled">
                        <ItemsControl ItemsSource="{Binding FileItems}" Margin="16,12,16,12">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <StackPanel Spacing="8" Margin="0,0,0,8" />
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>

                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <!-- å®Œæ•´çš„æ–‡ä»¶é¡¹æ¨¡æ¿ - ä¸ŽClienté¡¹ç›®ä¸€è‡´ -->
                                    <Border Background="White"
                                            BorderBrush="#e5e7eb"
                                            BorderThickness="1"
                                            CornerRadius="12"
                                            Padding="16"
                                            Margin="0,0,0,8">
                                        <!-- æ·»åŠ é˜´å½±æ•ˆæžœ -->
                                        <Border.Effect>
                                            <DropShadowEffect Color="#000000"
                                                            Opacity="0.05"
                                                            BlurRadius="10"
                                                            OffsetX="0"
                                                            OffsetY="1" />
                                        </Border.Effect>

                                        <Grid>
                                            <!-- ä¸»å†…å®¹ç½‘æ ¼ -->
                                            <Grid Name="ContentGrid">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="80" />
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>

                                                <!-- ç¼©ç•¥å›¾ - ä¸ŽClienté¡¹ç›®ä¸€è‡´ -->
                                                <Border Grid.Column="0"
                                                        Background="#f9fafb"
                                                        BorderBrush="#e5e7eb"
                                                        BorderThickness="1"
                                                        CornerRadius="8"
                                                        Width="64"
                                                        Height="64">
                                                    <Grid>
                                                        <!-- ç¼©ç•¥å›¾å›¾ç‰‡ -->
                                                        <Image Source="{Binding Thumbnail}"
                                                               Stretch="UniformToFill"
                                                               IsVisible="{Binding HasThumbnail}" />

                                                        <!-- ç¼©ç•¥å›¾å ä½ç¬¦ -->
                                                        <Grid IsVisible="{Binding !HasThumbnail}">
                                                            <Rectangle Fill="#e5e7eb" />
                                                            <TextBlock Text="ðŸŽ¬"
                                                                       FontSize="24"
                                                                       HorizontalAlignment="Center"
                                                                       VerticalAlignment="Center"
                                                                       Foreground="#9ca3af" />
                                                        </Grid>
                                                    </Grid>
                                                </Border>

                                                <!-- æ–‡ä»¶ä¿¡æ¯ -->
                                                <StackPanel Grid.Column="1"
                                                            Margin="16,0"
                                                            VerticalAlignment="Center">

                                                    <!-- æ–‡ä»¶å -->
                                                    <TextBlock Text="{Binding FileName}"
                                                            FontSize="16"
                                                            FontWeight="SemiBold"
                                                            Foreground="#111827"
                                                            TextTrimming="CharacterEllipsis"
                                                            MaxWidth="500"
                                                            TextWrapping="NoWrap"
                                                            Margin="0,0,0,8" />

                                                    <!-- ä¸‰åˆ—å¸ƒå±€ï¼šåŽŸè§†é¢‘ä¿¡æ¯ | ç®­å¤´ | è½¬æ¢åŽä¿¡æ¯ -->
                                                    <Grid Margin="0,0,0,8">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*" />
                                                            <ColumnDefinition Width="Auto" />
                                                            <ColumnDefinition Width="*" />
                                                        </Grid.ColumnDefinitions>

                                                        <!-- å·¦ä¾§ï¼šåŽŸè§†é¢‘ä¿¡æ¯ -->
                                                        <StackPanel Grid.Column="0"
                                                                    HorizontalAlignment="Center"
                                                                    Spacing="6">
                                                            <!-- ç¬¬ä¸€è¡Œï¼šæ ¼å¼å’Œåˆ†è¾¨çŽ‡ -->
                                                            <StackPanel Orientation="Horizontal"
                                                                        HorizontalAlignment="Center"
                                                                        Spacing="8">
                                                                <!-- æºæ ¼å¼ -->
                                                                <Border Background="#f3f4f6"
                                                                        CornerRadius="4"
                                                                        Padding="6,3">
                                                                    <TextBlock Text="{Binding SourceFormat}"
                                                                            FontSize="12"
                                                                            Foreground="#374151"
                                                                            FontWeight="Medium" />
                                                                </Border>

                                                                <!-- æºåˆ†è¾¨çŽ‡ -->
                                                                <TextBlock Text="{Binding SourceResolution}"
                                                                        FontSize="12"
                                                                        Foreground="#6b7280"
                                                                        VerticalAlignment="Center" />
                                                            </StackPanel>

                                                            <!-- ç¬¬äºŒè¡Œï¼šæ–‡ä»¶å¤§å°å’Œæ—¶é•¿ -->
                                                            <StackPanel Orientation="Horizontal"
                                                                        HorizontalAlignment="Center"
                                                                        Spacing="8">
                                                                <!-- æºæ–‡ä»¶å¤§å° -->
                                                                <TextBlock Text="{Binding FileSize}"
                                                                        FontSize="12"
                                                                        Foreground="#6b7280" />

                                                                <!-- åˆ†éš”ç¬¦ -->
                                                                <TextBlock Text="â€¢"
                                                                        FontSize="12"
                                                                        Foreground="#d1d5db" />

                                                                <!-- æºæ—¶é•¿ -->
                                                                <TextBlock Text="{Binding Duration}"
                                                                        FontSize="12"
                                                                        Foreground="#6b7280" />
                                                            </StackPanel>
                                                        </StackPanel>

                                                        <!-- ä¸­é—´ï¼šè½¬æ¢ç®­å¤´ -->
                                                        <TextBlock Grid.Column="1"
                                                                Text="â†’"
                                                                FontSize="16"
                                                                Foreground="#8b5cf6"
                                                                VerticalAlignment="Center"
                                                                HorizontalAlignment="Center"
                                                                Margin="16,0" />

                                                        <!-- å³ä¾§ï¼šè½¬æ¢åŽä¿¡æ¯ -->
                                                        <StackPanel Grid.Column="2"
                                                                    HorizontalAlignment="Center"
                                                                    Spacing="6">
                                                            <!-- ç¬¬ä¸€è¡Œï¼šæ ¼å¼å’Œåˆ†è¾¨çŽ‡ -->
                                                            <StackPanel Orientation="Horizontal"
                                                                        HorizontalAlignment="Center"
                                                                        Spacing="8">
                                                                <!-- ç›®æ ‡æ ¼å¼ -->
                                                                <Border Background="#ede9fe"
                                                                        CornerRadius="4"
                                                                        Padding="6,3">
                                                                    <TextBlock Text="{Binding TargetFormat}"
                                                                            FontSize="12"
                                                                            Foreground="#7c3aed"
                                                                            FontWeight="Medium" />
                                                                </Border>

                                                                <!-- ç›®æ ‡åˆ†è¾¨çŽ‡ -->
                                                                <TextBlock Text="{Binding TargetResolution}"
                                                                        FontSize="12"
                                                                        Foreground="#6b7280"
                                                                        VerticalAlignment="Center" />
                                                            </StackPanel>

                                                            <!-- ç¬¬äºŒè¡Œï¼šé¢„ä¼°æ–‡ä»¶å¤§å°å’Œæ—¶é•¿ -->
                                                            <StackPanel Orientation="Horizontal"
                                                                        HorizontalAlignment="Center"
                                                                        Spacing="8">
                                                                <!-- é¢„ä¼°æ–‡ä»¶å¤§å° -->
                                                                <TextBlock Text="{Binding EstimatedFileSize}"
                                                                        FontSize="12"
                                                                        Foreground="#6b7280" />

                                                                <!-- åˆ†éš”ç¬¦ -->
                                                                <TextBlock Text="â€¢"
                                                                        FontSize="12"
                                                                        Foreground="#d1d5db" />

                                                                <!-- é¢„ä¼°æ—¶é•¿ -->
                                                                <TextBlock Text="{Binding EstimatedDuration}"
                                                                        FontSize="12"
                                                                        Foreground="#6b7280" />
                                                            </StackPanel>
                                                        </StackPanel>
                                                    </Grid>

                                                    <!-- è¿›åº¦ä¿¡æ¯ -->
                                                    <StackPanel>
                                                        <!-- çŠ¶æ€æ–‡æœ¬å’Œè¿›åº¦ç™¾åˆ†æ¯” -->
                                                        <Grid Margin="0,0,0,6">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*" />
                                                                <ColumnDefinition Width="Auto" />
                                                            </Grid.ColumnDefinitions>

                                                            <!-- çŠ¶æ€æ–‡æœ¬ -->
                                                            <TextBlock Grid.Column="0"
                                                                    Text="{Binding StatusText}"
                                                                    FontSize="12"
                                                                    Foreground="#6b7280"
                                                                    VerticalAlignment="Center" />

                                                            <!-- è¿›åº¦ç™¾åˆ†æ¯” -->
                                                            <TextBlock Grid.Column="1"
                                                                    Text="{Binding Progress, StringFormat={}{0:F0}%}"
                                                                    FontSize="12"
                                                                    Foreground="#8b5cf6"
                                                                    FontWeight="Medium"
                                                                    VerticalAlignment="Center" />
                                                        </Grid>

                                                        <!-- è¿›åº¦æ¡ -->
                                                        <ProgressBar Value="{Binding Progress}"
                                                                    Maximum="100"
                                                                    Height="6"
                                                                    Background="#f3f4f6"
                                                                    Foreground="#8b5cf6"
                                                                    CornerRadius="3">
                                                            <ProgressBar.Styles>
                                                                <Style Selector="ProgressBar">
                                                                    <Setter Property="BorderThickness" Value="0" />
                                                                </Style>
                                                            </ProgressBar.Styles>
                                                        </ProgressBar>
                                                    </StackPanel>
                                                </StackPanel>

                                                <!-- è½¬æ¢æŒ‰é’® -->
                                                <StackPanel Grid.Column="2"
                                                            VerticalAlignment="Center"
                                                            Margin="16,0,0,0">
                                                    <Button Background="#8b5cf6"
                                                            Foreground="White"
                                                            Padding="16,8"
                                                            CornerRadius="8"
                                                            FontSize="13"
                                                            FontWeight="Medium"
                                                            Command="{Binding StartConversionCommand}"
                                                            BorderThickness="0">
                                                        <Button.Content>
                                                            <TextBlock Text="è½¬æ¢" VerticalAlignment="Center" />
                                                        </Button.Content>

                                                        <Button.Styles>
                                                            <!-- é»˜è®¤æ‚¬åœæ•ˆæžœ -->
                                                            <Style Selector="Button:pointerover">
                                                                <Setter Property="Background" Value="#7c3aed" />
                                                            </Style>
                                                        </Button.Styles>
                                                    </Button>
                                                </StackPanel>
                                            </Grid>

                                            <!-- åˆ é™¤æŒ‰é’®ï¼ˆå³ä¸Šè§’ï¼‰ -->
                                            <Button Content="âœ•"
                                                    Background="Transparent"
                                                    Foreground="#9ca3af"
                                                    BorderThickness="0"
                                                    Padding="0"
                                                    FontSize="14"
                                                    FontWeight="Bold"
                                                    HorizontalAlignment="Right"
                                                    VerticalAlignment="Top"
                                                    Margin="0,-2,0,0"
                                                    Width="20"
                                                    Height="20"
                                                    CornerRadius="10"
                                                    Command="{Binding RemoveCommand}">
                                                <Button.Styles>
                                                    <Style Selector="Button:pointerover">
                                                        <Setter Property="Background" Value="#fef2f2" />
                                                        <Setter Property="Foreground" Value="#ef4444" />
                                                    </Style>
                                                </Button.Styles>
                                            </Button>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Border>
            </Grid>
        </Grid>
    </Border>

</UserControl>
